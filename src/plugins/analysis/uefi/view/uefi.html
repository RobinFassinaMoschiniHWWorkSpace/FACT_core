{% extends "analysis_plugins/general_information.html" %}

{% block analysis_result_details %}
    {% for category, result_list in analysis_result.vulnerabilities | groupby("category") %}
        <tr>
            <td>{{ category | safe }}</td>
            <td class="p-0">
                <table class="table table-bordered m-0" style="width: 100%">
                    {% for rule_results in result_list %}
                        <tr>
                            <td style="width: 20%">{{ rule_results.name | safe }}</td>
                            <td class="p-0">
                                <table class="table table-bordered m-0" style="width: 100%">
                                    {% if rule_results.url %}
                                        <tr>
                                            <td>url</td>
                                            <td><a href="{{ rule_results.url | safe }}">{{ rule_results.url | safe }}</a></td>
                                        </tr>
                                    {% endif %}
                                    <tr>
                                        <td style="width: 25%">author</td>
                                        <td>{{ rule_results.author | safe }}</td>
                                    </tr>
                                    <tr>
                                        <td>variants</td>
                                        <td class="p-0">
                                            <table class="table table-bordered m-0" style="width: 100%">
                                                {% for variant_data in rule_results.variants %}
                                                    <tr>
                                                        <td>{{ variant_data.name | safe }}</td>
                                                        {% if variant_data.match %}
                                                            <td class="table-danger" style="width: 50%">{{ variant_data.output | safe }}</td>
                                                        {% else %}
                                                            <td class="table-success" style="width: 50%">{{ variant_data.output | safe }}</td>
                                                        {% endif %}
                                                    </tr>
                                                {% endfor %}
                                            </table>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    {% endfor %}
                </table>
            </td>
        </tr>
    {% endfor %}

{% endblock %}

